// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.943
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"github.com/nathanhollows/Rapua/v6/blocks"
	bTemplates "github.com/nathanhollows/Rapua/v6/internal/templates/blocks"
	"github.com/nathanhollows/Rapua/v6/models"
)

type EditPageData struct {
	Settings   models.InstanceSettings
	PageBlocks blocks.Blocks
	PageTitle  string
	PageType   string
}

func EditPage(data EditPageData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!-- Header --><div class=\"flex flex-col sm:flex-row gap-3 justify-between items-center w-full p-5\"><h1 class=\"text-2xl font-bold\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 string
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(data.PageTitle)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/admin/system_pages.templ`, Line: 19, Col: 49}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, " Page</h1><div class=\"tooltip\" data-tip=\"System page - cannot be deleted\"><div class=\"badge badge-ghost gap-1\"><svg class=\"w-3 h-3\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"18\" height=\"11\" x=\"3\" y=\"11\" rx=\"2\" ry=\"2\"></rect> <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"></path></svg> System Page</div></div></div><div class=\"flex flex-col lg:flex-row w-full gap-8 p-5 pt-0\"><div class=\"flex flex-col flex-grow min-w-0\"><!-- Blocks --><section>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = blockAddDropdown(data.Settings.InstanceID, getContextForPageType(data.PageType), ".blocks").Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "<!-- Hidden alert templates --><div id=\"missing-game-status-template\" class=\"alert alert-warning\" style=\"display: none;\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"w-6 h-6\"><path d=\"M12 9v4\"></path> <path d=\"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636-2.87L13.637 3.59a1.914 1.914 0 0 0-3.274 0z\"></path> <path d=\"M12 16h.01\"></path></svg> <span>Recommended: Add a <strong>Game Status</strong> block to show game state to players</span></div><div id=\"missing-start-button-template\" class=\"alert alert-warning\" style=\"display: none;\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"w-6 h-6\"><path d=\"M12 9v4\"></path> <path d=\"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636-2.87L13.637 3.59a1.914 1.914 0 0 0-3.274 0z\"></path> <path d=\"M12 16h.01\"></path></svg> <span>Recommended: Add a <strong>Start Button</strong> block so players can begin the game</span></div><div id=\"missing-game-status-finish-template\" class=\"alert alert-info\" style=\"display: none;\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"w-6 h-6\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle> <path d=\"M12 16v-4\"></path> <path d=\"M12 8h.01\"></path></svg> <span>Optional: Add a <strong>Game Status</strong> block to show game completion</span></div><div id=\"blocks-container\" class=\"blocks flex flex-col gap-5\" data-page-type=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var3 string
		templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(data.PageType)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/admin/system_pages.templ`, Line: 63, Col: 35}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		for _, block := range data.PageBlocks {
			templ_7745c5c3_Err = bTemplates.RenderAdminBlock(data.Settings, block, len(data.PageBlocks) < 4).Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "</div><script>\n\t\t\t\tfunction checkMissingBlocks() {\n\t\t\t\t\tconst container = document.getElementById('blocks-container');\n\t\t\t\t\tconst pageType = container.dataset.pageType;\n\n\t\t\t\t\t// Remove existing alerts\n\t\t\t\t\tdocument.querySelectorAll('#missing-game-status, #missing-start-button').forEach(el => el.remove());\n\n\t\t\t\t\tconst blocks = container.querySelectorAll('.content-block');\n\t\t\t\t\tlet hasGameStatus = false;\n\t\t\t\t\tlet hasStartButton = false;\n\n\t\t\t\t\tblocks.forEach(block => {\n\t\t\t\t\t\tconst blockType = block.dataset.blockType;\n\t\t\t\t\t\tif (blockType === 'game_status_alert') hasGameStatus = true;\n\t\t\t\t\t\tif (blockType === 'start_game_button') hasStartButton = true;\n\t\t\t\t\t});\n\n\t\t\t\t\tconst firstBlock = container.querySelector('.content-block');\n\n\t\t\t\t\tif (pageType === 'start') {\n\t\t\t\t\t\tif (!hasGameStatus) {\n\t\t\t\t\t\t\tconst alert = document.getElementById('missing-game-status-template').cloneNode(true);\n\t\t\t\t\t\t\talert.id = 'missing-game-status';\n\t\t\t\t\t\t\talert.style.display = '';\n\t\t\t\t\t\t\tif (firstBlock) {\n\t\t\t\t\t\t\t\tcontainer.insertBefore(alert, firstBlock);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontainer.appendChild(alert);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!hasStartButton) {\n\t\t\t\t\t\t\tconst alert = document.getElementById('missing-start-button-template').cloneNode(true);\n\t\t\t\t\t\t\talert.id = 'missing-start-button';\n\t\t\t\t\t\t\talert.style.display = '';\n\t\t\t\t\t\t\tif (firstBlock) {\n\t\t\t\t\t\t\t\tcontainer.insertBefore(alert, firstBlock);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontainer.appendChild(alert);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (pageType === 'end') {\n\t\t\t\t\t\tif (!hasGameStatus) {\n\t\t\t\t\t\t\tconst alert = document.getElementById('missing-game-status-finish-template').cloneNode(true);\n\t\t\t\t\t\t\talert.id = 'missing-game-status';\n\t\t\t\t\t\t\talert.style.display = '';\n\t\t\t\t\t\t\tif (firstBlock) {\n\t\t\t\t\t\t\t\tcontainer.insertBefore(alert, firstBlock);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontainer.appendChild(alert);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Run on load\n\t\t\t\tcheckMissingBlocks();\n\n\t\t\t\t// Run after HTMX swaps\n\t\t\t\tdocument.getElementById('blocks-container').addEventListener('htmx:afterSwap', checkMissingBlocks);\n\t\t\t\t</script></section></div><!-- Preview -->")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = mobilePreview(data.Settings.InstanceID, getPreviewURLForPageType(data.PageType), "htmx:afterSwap from:.blocks").Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "</div><!-- Hidden form for block reordering via HTMX -->")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = blockReorderForm().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = deleteBlockModal().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = previewSortableScript().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = blockMoveScript().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = sortableStyles().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func getContextForPageType(pageType string) blocks.BlockContext {
	if pageType == "start" {
		return blocks.ContextLobby
	}
	return blocks.ContextFinish
}

func getPreviewURLForPageType(pageType string) string {
	if pageType == "start" {
		return "/lobby"
	}
	return "/finish"
}

var _ = templruntime.GeneratedTemplate
