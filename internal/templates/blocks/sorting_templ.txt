<div id=\"
\" class=\"sorting-item join-item border border-x-0 border-base-300 flex justify-between items-center px-4 py-2 text-success\" data-id=\"
\"><div class=\"flex-grow\">
</div><div class=\"flex flex-shrink-0 ml-2 items-center gap-2\"><span class=\"badge badge-sm badge-success\">
</span></div></div>
<div id=\"
\" class=\"sorting-item join-item border border-x-0 border-base-300 flex justify-between items-center px-4 py-2 text-error\" data-id=\"
\"><div class=\"flex-grow\">
</div><div class=\"flex flex-shrink-0 ml-2 items-center gap-2\"><span class=\"badge badge-sm badge-error\">
</span></div></div>
<div id=\"
\" class=\"indicator w-full\">
<span class=\"indicator-item indicator-top indicator-center badge badge-info\">
 pts</span>
<div class=\"card bg-base-200 shadow-lg w-full\"><div class=\"prose p-5\">
</div><form id=\"
\" hx-post=\"
\" hx-target=\"
\"><input type=\"hidden\" name=\"block\" value=\"
\"><div id=\"
\" class=\"sort-container mt-4 join join-vertical w-full rounded-none\">
</div>
<div class=\"flex justify-center my-4\"><button class=\"btn btn-primary btn-wide\">Check <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-send-horizontal-icon lucide-send-horizontal w-5 h-5\"><path d=\"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z\"></path><path d=\"M6 12h16\"></path></svg></button></div>
<div class=\"p-4\"><div class=\"alert alert-success\"><svg xmlns=\"http://www.w3.org/2000/svg\" class=\"stroke-current shrink-0 h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg> <span>Correct! Your order is perfect.</span></div></div>
</form></div></div><script>\n\t\t// Initialize sortable functionality on the sort container\n\t\tdocument.addEventListener('DOMContentLoaded', function() {\n\t\t\tconst sortContainer = document.getElementById('{ fmt.Sprintf(\"sorting-items-%s\", block.ID) }');\n\t\t\tconst form = document.getElementById('{ fmt.Sprintf(\"sorting-form-%s\", block.ID) }');\n\t\t\t\n\t\t\tif (sortContainer && form && !{ fmt.Sprint(data.IsComplete()) }) {\n\t\t\t\t// Initialize Sortable for drag and drop\n\t\t\t\tnew Sortable(sortContainer, {\n\t\t\t\t\tanimation: 150,\n\t\t\t\t\tghostClass: 'sortable-ghost',\n\t\t\t\t\tchosenClass: 'sortable-chosen',\n\t\t\t\t\tdragClass: 'sortable-drag',\n\t\t\t\t\tonEnd: function() {\n\t\t\t\t\t\t// When sorting ends, update the hidden inputs to reflect new order\n\t\t\t\t\t\tupdateSortingOrder(sortContainer, form);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// Set up the up/down buttons to move items\n\t\t\t\tsortContainer.querySelectorAll('.join-vertical button').forEach(btn => {\n\t\t\t\t\tbtn.addEventListener('click', function(e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst item = e.target.closest('.sorting-item');\n\t\t\t\t\t\tconst isUp = e.target.closest('button').getAttribute('data-tip') === 'Move up';\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (isUp) {\n\t\t\t\t\t\t\tconst prev = item.previousElementSibling;\n\t\t\t\t\t\t\tif (prev) {\n\t\t\t\t\t\t\t\tsortContainer.insertBefore(item, prev);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst next = item.nextElementSibling;\n\t\t\t\t\t\t\tif (next) {\n\t\t\t\t\t\t\t\tsortContainer.insertBefore(next, item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Update the form data after moving\n\t\t\t\t\t\tupdateSortingOrder(sortContainer, form);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// Add a submit handler to make sure the form has the current order\n\t\t\t\tform.addEventListener('submit', function(e) {\n\t\t\t\t\tupdateSortingOrder(sortContainer, form);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t\n\t\t// Function to update the sorting-item-order hidden inputs\n\t\tfunction updateSortingOrder(container, form) {\n\t\t\t// Clear any existing inputs\n\t\t\tconst oldInputs = form.querySelectorAll('input[name=\"sorting-item-order\"]');\n\t\t\toldInputs.forEach(input => {\n\t\t\t\tif (input.parentNode !== container.querySelector('.sorting-item')) {\n\t\t\t\t\tinput.remove();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t// Get current order of items\n\t\t\tconst items = container.querySelectorAll('.sorting-item');\n\t\t\t\n\t\t\t// Add fresh inputs in the current order\n\t\t\titems.forEach(item => {\n\t\t\t\tconst itemId = item.getAttribute('data-id');\n\t\t\t\t\n\t\t\t\t// Check if this item already has the input inside it\n\t\t\t\tlet input = item.querySelector('input[name=\"sorting-item-order\"]');\n\t\t\t\tif (!input) {\n\t\t\t\t\t// If not found inside, create a new one\n\t\t\t\t\tinput = document.createElement('input');\n\t\t\t\t\tinput.type = 'hidden';\n\t\t\t\t\tinput.name = 'sorting-item-order';\n\t\t\t\t\tinput.value = itemId;\n\t\t\t\t\tform.appendChild(input);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t</script>
<div id=\"
\" class=\"sorting-item join-item border border-x-0 border-base-300 flex justify-between items-center px-4 py-2 cursor-grab\" data-id=\"
\" data-correct-position=\"
\"><input type=\"hidden\" name=\"sorting-item-order\" value=\"
\"><div class=\"flex-grow\">
</div><div class=\"flex flex-shrink-0 ml-2\"><span class=\"join join-vertical\"><button type=\"button\" class=\"btn btn-xs btn-ghost join-item tooltip tooltip-left\" data-tip=\"Move up\" onclick=\"moveSortingItemUp(event)\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"18 15 12 9 6 15\"></polyline></svg></button> <button type=\"button\" class=\"btn btn-xs btn-ghost join-item tooltip tooltip-left\" data-tip=\"Move down\" onclick=\"moveSortingItemDown(event)\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg></button></span></div><!-- Hidden inputs will be generated by the updateOrderBeforeSubmit function --></div>
<form id=\"
\" hx-post=\"
\" hx-trigger=\"
\" hx-swap=\"none\">
<label class=\"form-control w-full\"><div class=\"label\"><span class=\"label-text font-bold\">Points</span></div><label class=\"input input-bordered flex items-center gap-2\"><input name=\"points\" type=\"number\" class=\"grow\" placeholder=\"Points\" value=\"
\"> <span class=\"badge badge-info tooltip tooltip-left\" data-tip=\"Set to 0 to disable\">Optional</span></label></label> 
<label class=\"form-control w-full mt-5\"><div class=\"label\"><span class=\"label-text font-bold\">Scoring Scheme</span></div><select name=\"scoring_scheme\" class=\"select select-bordered w-full\"><option value=\"all_or_nothing\"
 selected
>All or Nothing</option> <option value=\"correct_item_correct_place\"
 selected
>Correct Item, Correct Place</option> <option value=\"retry_until_correct\"
 selected
>Retry Until Correct</option></select><div class=\"label\"><span class=\"label-text-alt\">Choose how points will be awarded:<ul class=\"mt-1 list-disc list-inside text-xs\"><li><strong>All or Nothing</strong>: One attempt only, full points or zero</li><li><strong>Correct Item, Correct Place</strong>: Points for each correctly placed item</li><li><strong>Retry Until Correct</strong>: Multiple attempts allowed until correct</li></ul></span></div></label><label for=\"
\" class=\"form-control w-full mt-5\"><div class=\"label\"><span class=\"label-text font-bold\">Instructions</span></div><textarea id=\"
\" name=\"content\" rows=\"2\" class=\"markdown-textarea textarea textarea-bordered w-full font-mono pt-3\" style=\"field-sizing: content;\" placeholder=\"Markdown content here...\">
</textarea></label><div class=\"form-control w-full\"><div class=\"label font-bold flex justify-between\">Sorting Items <button class=\"btn btn-outline btn-sm my-2\" type=\"button\" onclick=\"addSortingItem(event)\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-list-plus w-5 h-5\"><path d=\"M11 12H3\"></path><path d=\"M16 6H3\"></path><path d=\"M16 18H3\"></path><path d=\"M18 9v6\"></path><path d=\"M21 12h-6\"></path></svg> Add Item</button></div><div id=\"sorting-items\" class=\"sorting-admin flex flex-col join join-vertical bg-base-100\">
</div></div></form><script>\n\tfunction addSortingItem(event) {\n\t\tevent.preventDefault();\n\t\tconst sortingContainer = document.getElementById('sorting-items');\n\t\tconst newItem = document.createElement('label');\n\t\tnewItem.classList.add('sorting-item', 'input', 'input-bordered', 'bg-base-100', 'flex', 'flex-row', 'items-top', 'gap-2', 'h-auto', 'join-item');\n\n\t\tnewItem.innerHTML = `\n\t\t\t<textarea\n\t\t\t\tname=\"sorting-items\"\n\t\t\t\tclass=\"w-full textarea hover:border-0 hover:outline-0 focus:border-0 focus:outline-0 border-0 outline-0 pr-20 bg-transparent\"\n\t\t\t\trows=\"1\"\n\t\t\t\tplaceholder=\"Sorting item description...\"\n\t\t\t\tautoComplete=\"off\"\n\t\t\t></textarea>\n\t\t\t<input type=\"hidden\" name=\"sorting-item-ids\" value=\"\" />\n\t\t\t<div class=\"flex gap-1 mt-2\">\n\t\t\t\t<span class=\"join join-horizontal\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-xs join-item tooltip\" data-tip=\"Move up\" onclick=\"moveSortingItemUp(event)\">\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-move-up w-3 h-3\"><path d=\"M8 6L12 2L16 6\"></path><path d=\"M12 2V22\"></path></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-xs join-item tooltip\" data-tip=\"Move down\" onclick=\"moveSortingItemDown(event)\">\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-move-down w-3 h-3\"><path d=\"M8 18L12 22L16 18\"></path><path d=\"M12 2V22\"></path></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t\t<button type=\"button\" class=\"btn btn-xs btn-circle hover:btn-error tooltip flex\" data-tip=\"Delete\" onclick=\"removeSortingItem(event)\">\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-trash-2 w-3 h-3\"><path d=\"M3 6h18\"></path><path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"></path><path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"></path><line x1=\"10\" x2=\"10\" y1=\"11\" y2=\"17\"></line><line x1=\"14\" x2=\"14\" y1=\"11\" y2=\"17\"></line></svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t\tsortingContainer.appendChild(newItem);\n\t}\n\n\tfunction removeSortingItem(event) {\n\t\tevent.preventDefault();\n\t\tconst item = event.target.closest('.sorting-item');\n\t\titem.remove();\n\t}\n\n\tfunction moveSortingItemUp(event) {\n\t\tevent.preventDefault();\n\t\tconst item = event.target.closest('.sorting-item');\n\t\tconst previousItem = item.previousElementSibling;\n\t\tif (previousItem && previousItem.classList.contains('sorting-item')) {\n\t\t\titem.parentNode.insertBefore(item, previousItem);\n\t\t}\n\t}\n\n\tfunction moveSortingItemDown(event) {\n\t\tevent.preventDefault();\n\t\tconst item = event.target.closest('.sorting-item');\n\t\tconst nextItem = item.nextElementSibling;\n\t\tif (nextItem && nextItem.classList.contains('sorting-item')) {\n\t\t\titem.parentNode.insertBefore(nextItem, item);\n\t\t}\n\t}\n\t</script>
<label class=\"sorting-item input input-bordered bg-transparent flex flex-row items-top gap-2 h-auto join-item\" data-item-id=\"
\">
<textarea name=\"sorting-items\" class=\"
\" style=\"field-sizing: content;\" rows=\"1\" value=\"
\" placeholder=\"Sorting item description...\" autoComplete=\"off\">
</textarea> <input type=\"hidden\" name=\"sorting-item-ids\" value=\"
\"><div class=\"flex gap-1 mt-2\"><span class=\"join join-horizontal\"><button type=\"button\" class=\"btn btn-xs join-item tooltip\" data-tip=\"Move up\" onclick=\"moveSortingItemUp(event)\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-move-up w-3 h-3\"><path d=\"M8 6L12 2L16 6\"></path><path d=\"M12 2V22\"></path></svg></button> <button type=\"button\" class=\"btn btn-xs join-item tooltip\" data-tip=\"Move down\" onclick=\"moveSortingItemDown(event)\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-move-down w-3 h-3\"><path d=\"M8 18L12 22L16 18\"></path><path d=\"M12 2V22\"></path></svg></button></span> <button type=\"button\" class=\"btn btn-xs btn-circle hover:btn-error tooltip flex\" data-tip=\"Delete\" onclick=\"removeSortingItem(event)\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-trash-2 w-3 h-3\"><path d=\"M3 6h18\"></path><path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"></path><path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"></path><line x1=\"10\" x2=\"10\" y1=\"11\" y2=\"17\"></line><line x1=\"14\" x2=\"14\" y1=\"11\" y2=\"17\"></line></svg></button></div></label>
